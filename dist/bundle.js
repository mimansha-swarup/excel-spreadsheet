(()=>{var __webpack_modules__={817:()=>{copyElement=document.querySelector(".copy"),cutElement=document.querySelector(".cut"),pasteElement=document.querySelector(".paste");let e=!1;document.addEventListener("keydown",(t=>{e=t.ctrlKey})),document.addEventListener("keyup",(t=>{e=t.ctrlKey}));for(let e=0;e<rows;e++)for(let t=0;t<columns;t++)l(document.querySelector(`.cell[rowId ="${e}"][columnId="${t}"]`));let t=[];function l(l){l.addEventListener("click",(r=>{if(!e)return;t.length>=2&&(o(),t=[]);const n=Number(l.getAttribute("rowId")),c=Number(l.getAttribute("columnId"));l.style.border="2px solid var(--primary-color)",t.push([n,c])}))}function o(){for(let e=0;e<t.length;e++)document.querySelector(`.cell[rowId ="${t[e][0]}"][columnId="${t[e][1]}"]`).style.border="1px solid var(--border-color)"}let r=[];cutElement.addEventListener("click",(()=>{if(t.length<2)return;const[e,l,n,c]=t.flat();for(let t=e;t<=n;t++){const e=[];for(let o=l;o<=c;o++){const l=document.querySelector(`.cell[rowId ="${t}"][columnId="${o}"]`),r=cellsStorage[t][o];e.push({...r}),r.value="",r.bold=!1,r.underline=!1,r.italic=!1,r.color=defaultColor,r.bgColor=defaultBgColor,r.alignment="left",r.fontFamily="monospace",r.fontSize="12",l.click()}r.push(e)}o()})),copyElement.addEventListener("click",(()=>{if(t.length<2)return;const[e,l,n,c]=t.flat();for(let t=e;t<=n;t++){const e=[];for(let o=l;o<=c;o++)e.push(cellsStorage[t][o]);r.push(e)}o()})),pasteElement.addEventListener("click",(()=>{const[e,l]=getActivateCellIds(addressBar.value),o=Math.abs(t[0][0]-t[1][0]),n=Math.abs(t[0][1]-t[1][1]);for(let t=e,c=0;t<=e+o;t++,c++)for(let e=l,o=0;e<=l+n;e++,o++){const l=document.querySelector(`.cell[rowId ="${t}"][columnId="${e}"]`);if(!l)return;const n=cellsStorage[t][e],a=r[c][o];n.value=a.value,n.bold=a.bold,n.underline=a.underline,n.italic=a.italic,n.color=a.color,n.bgColor=a.bgColor,n.alignment=a.alignment,n.fontFamily=a.fontFamily,n.fontSize=a.fontSize,l.click()}}))},327:()=>{let e=[];for(let t=0;t<rows;t++){const t=[];for(let e=0;e<columns;e++)t.push([]);e.push(t)}},923:()=>{for(let e=0;e<rows;e++)for(let t=0;t<columns;t++){const l=document.querySelector(`.cell[rowId ="${e}"][columnId="${t}"]`);l.addEventListener("blur",(()=>{const e=addressBar.value,[t,l]=getCell(e);l.value=t.innerText}))}const formulaBarElement=document.querySelector(".formula-bar");function addChildToGraphComponent(e,t){const[l,o]=getActivateCellIds(t),r=e.split(" ");for(let e=0;e<r.length;e++)if(r[e].charCodeAt(0)>=65&&r[e].charCodeAt(0)<=90){const[t,n]=getActivateCellIds(r[e]);graphMatrix[t][n].push([l,o])}}function removeChildFromGraphComponent(e){const t=e.split(" ");for(let e=0;e<t.length;e++)if(t[e].charCodeAt(0)>=65&&t[e].charCodeAt(0)<=90){const[l,o]=getActivateCellIds(t[e]);graphMatrix[l][o].pop()}}function updateChildrenOnParentChanges(e){const[,t]=getCell(e);children=t.children;for(let e=0;e<children?.length;e++){const t=children[e],[,l]=getCell(t),o=l.formulaBar;setCellAndDB(evaluateExpression(o),o,t),updateChildrenOnParentChanges(t)}}function addChildToParent(e){const t=addressBar.value,l=e.split(" ");for(let e=0;e<l.length;e++)if(l[e].charCodeAt(0)>=65&&l[e].charCodeAt(0)<=90){const[,o]=getCell(l[e]);o.children.push(t)}}function removeChildFromParent(e){const t=addressBar.value,l=e.split(" ");for(let e=0;e<l.length;e++)if(l[e].charCodeAt(0)>=65&&l[e].charCodeAt(0)<=90){const[,o]=getCell(l[e]),r=o.children.indexOf(t);r>=0&&o.children.splice(r,1)}}function evaluateExpression(expression){const encodedFormula=expression.split(" ");for(let e=0;e<encodedFormula.length;e++)if(encodedFormula[e].charCodeAt(0)>=65&&encodedFormula[e].charCodeAt(0)<=90){const[,t]=getCell(encodedFormula[e]);encodedFormula[e]=t.value}const decodeFormula=encodedFormula.join(" ");return eval(decodeFormula)}function setCellAndDB(e,t,l){const[o,r]=getCell(l);o.innerText=e,r.value=e,r.formulaBar=t}formulaBarElement.addEventListener("keydown",(async e=>{if(formulaBarElement.value&&"Enter"===e.key){const e=evaluateExpression(formulaBarElement.value),t=addressBar.value,[,l]=getCell(t);if(l.formula!==e&&removeChildFromParent(formulaBarElement.value),addChildToGraphComponent(formulaBarElement.value,t),cycleResponse=isGraphCyclic(),cycleResponse){let e=confirm("Formula is cyclic, Do you want to TRACE?");for(;e;)await cyclicPathTrace(graphMatrix,...cycleResponse),e=confirm("Formula is cyclic, Do you want to TRACE?");return void removeChildFromGraphComponent(formulaBarElement.value)}setCellAndDB(e,formulaBarElement.value,t),addChildToParent(formulaBarElement.value),updateChildrenOnParentChanges(t)}}))},286:()=>{const e=document.querySelector(".cell-row-cont"),t=document.querySelector(".cell-col-cont"),l=document.querySelector(".sheet-cells"),o=document.querySelector(".address-bar");for(let e=0;e<100;e++){const l=document.createElement("div");l.innerText=e+1,l.setAttribute("class","cell-col justify-center"),t.appendChild(l)}for(let t=0;t<26;t++){const l=document.createElement("div");l.innerText=String.fromCharCode(65+t),l.setAttribute("class","cell-row justify-center"),e.appendChild(l)}for(let e=0;e<100;e++){const t=document.createElement("div");t.setAttribute("class","flex");for(let l=0;l<26;l++){const o=document.createElement("div");o.setAttribute("class","cell"),o.setAttribute("contentEditable",!0),o.setAttribute("rowId",e),o.setAttribute("columnId",l),r(o,e,l),t.appendChild(o)}l.appendChild(t)}function r(e,t,l){e.addEventListener("click",(()=>{o.value=`${String.fromCharCode(65+l)}${t+1}`}))}},36:()=>{const e=document.querySelector(".material-symbols-outlined.add-btn"),t=document.querySelector(".sheet-cont");function l(){for(let e=0;e<rows;e++)for(let t=0;t<columns;t++)document.querySelector(`.cell[rowId ="${e}"][columnId="${t}"]`).click();const e=document.querySelector(".cell");e.click(),e.focus()}e.addEventListener("click",(()=>{const e=document.createElement("div");e.setAttribute("class","sheet");const o=document.querySelectorAll(".sheet");e.setAttribute("id",o.length),e.innerText=`sheet${o.length+1}`,t.appendChild(e),function(){const e=[];for(let t=0;t<rows;t++){const t=[];for(let e=0;e<columns;e++){const e={bold:!1,underline:!1,italic:!1,color:defaultColor,bgColor:defaultColor,alignment:"left",fontFamily:"monospace",fontSize:"12",value:"",formulaBar:"",children:[]};t.push(e)}e.push(t)}collectedCellsStorage.push(e)}(),function(){const e=[];for(let t=0;t<rows;t++){const t=[];for(let e=0;e<columns;e++)t.push([]);e.push(t)}collectedGraphMatrix.push(e)}(),function(e){e.addEventListener("click",(()=>{var t;t=Number(e.getAttribute("id")),cellsStorage=collectedCellsStorage[t],graphMatrix=collectedGraphMatrix[t],l(),function(e){const t=document.querySelectorAll(".sheet");for(let e=0;e<t.length;e++)t[e].style.border="none",t[e].style.color="var(--dark-grey-color)";e.style.color="var(--primary-color)",e.style.borderBottom="3px solid var(--primary-color)"}(e)}))}(e),function(e){e.addEventListener("mousedown",(t=>{if(2!==t.button)return;if(1===document.querySelectorAll(".sheet").length)return void alert("Atleast one sheet is necessary");if(!confirm("Delete?"))return;const o=Number(e.getAttribute("id"));collectedCellsStorage.splice(o,1),collectedGraphMatrix.splice(o,1),function(e){e.remove();const t=document.querySelectorAll(".sheet");for(let e=0;e<t.length;e++)t[e].setAttribute("id",e),t[e].innerText=`sheet${e+1}`,t[e].style.border="none",t[e].style.color="var(--dark-grey-color)";t[0].style.color="var(--primary-color)",t[0].style.borderBottom="3px solid var(--primary-color)"}(e),cellsStorage=collectedCellsStorage[0],graphMatrix=collectedGraphMatrix[0],l()}))}(e),e.click(),e.scrollIntoView()}))},543:()=>{let e=[];const t="#D3E3FD",l="transparent";document.querySelector(".material-symbols-outlined.add-btn").click();const o=document.querySelector(".bold"),r=document.querySelector(".italic"),n=document.querySelector(".underlined"),c=document.querySelector(".font-size-prop"),a=document.querySelector(".font-family-prop"),d=document.querySelectorAll(".align"),s=d[0],u=d[1],i=d[2],m=document.querySelectorAll(".cell");function f(e){switch(e){case"left":s.style.backgroundColor=t,u.style.backgroundColor=l,i.style.backgroundColor=l;break;case"center":u.style.backgroundColor=t,s.style.backgroundColor=l,i.style.backgroundColor=l;break;case"right":i.style.backgroundColor=t,s.style.backgroundColor=l,u.style.backgroundColor=l}}o.addEventListener("click",(()=>{const[e,r]=y(addressBar.value);r.bold=!r.bold,e.style.fontWeight=r.bold?"bold":"normal",o.style.backgroundColor=r.bold?t:l,e.focus()})),r.addEventListener("click",(()=>{const[e,o]=y(addressBar.value);o.italic=!o.italic,e.style.fontStyle=o.italic?"italic":"normal",r.style.backgroundColor=o.italic?t:l,e.focus()})),n.addEventListener("click",(()=>{const[e,o]=y(addressBar.value);o.underlined=!o.underlined,e.style.textDecoration=o.underlined?"underline":"normal",n.style.backgroundColor=o.underlined?t:l,e.focus()})),c.addEventListener("change",(e=>{const[t,l]=y(addressBar.value);l.fontSize=e.target.value,t.style.fontSize=l.fontSize+"px",c.value=l.fontSize,t.focus()})),a.addEventListener("change",(e=>{const[t,l]=y(addressBar.value);l.fontFamily=e.target.value,t.style.fontFamily=l.fontFamily,a.value=l.fontFamily,t.focus()})),d.forEach((e=>{e.addEventListener("click",(e=>{const[t,l]=y(addressBar.value);l.alignment=e.target.innerText.split("_")[2],t.style.textAlign=l.alignment,f(l.alignment),t.focus()}))}));for(let e=0;e<m.length;e++)p(m[e]);function p(d){d.addEventListener("click",(()=>{const[s,u]=h(addressBar.value),i=e[s][u];d.style.fontWeight=i.bold?"bold":"normal",d.style.fontStyle=i.italic?"italic":"normal",d.style.textDecoration=i.underlined,d.style.fontSize=i.fontSize+"px",d.style.fontFamily=i.fontFamily,d.style.textAlign=i.alignment,o.style.backgroundColor=i.bold?t:l,r.style.backgroundColor=i.italic?t:l,n.style.backgroundColor=i.underlined?t:l,a.value=i.fontFamily,c.value=i.fontSize,f(i.alignment),formulaBarElement.value=i.formulaBar,d.innerText=i.value}))}function y(t){const[l,o]=h(t);return[document.querySelector(`.cell[rowId ="${l}"][columnId="${o}"]`),e[l][o]]}function h(e){const t=e?.[0]?.charCodeAt(0)-65;return[parseInt(e?.substring(1),10)-1,t]}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var l=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](l,l.exports,__webpack_require__),l.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var l in t)__webpack_require__.o(t,l)&&!__webpack_require__.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var __webpack_exports__={};(()=>{"use strict";__webpack_require__(286),__webpack_require__(327),__webpack_require__(36),__webpack_require__(543),__webpack_require__(923),__webpack_require__(817)})()})();